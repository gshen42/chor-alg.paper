
%% In this section, we define the correctness condition for our CP language.
%% %
%% The goal is to show a form of semantic equivalence that EPP preserves and reflects the semantics of the original choreography.
%% %
%% Traditionally, this form of semantic equivalence is decomposed into two separate theorems --- soundness and completeness.
%% %
%% The exact definitions and proofs are still work in progress, here we only show their types to demonsrtate the key idea.
%% %
%% Note that we are not proposing anything new here.
%% %
%% Instead, we are merely showing that our algebraic effects approach is capable of doing the standard proofs.

\begin{code}[hide]
open import 02-algeff

module 04-proofs (ğ•ƒ : Sig) where

open import Effect.Monad using (RawMonad)
open import Level using (Level)

import 03-choreo
open module 03-choreoâ€² = 03-choreo ğ•ƒ
open 03-choreoâ€².Process
\end{code}

%% \subsection{Semantics of Choreographies and Networks}

%% We first define operational semantics for choreographies and networks.
%% %
%% The operational sematnics for choreographies treats all located values as normal values and has the following definition:
%
\begin{center}\begin{code}[hide]
opaque
  noAt : At
  noAt A _ = A

data _â‡’á¶œ_ {A : Set} : Term (â„‚ noAt) A â†’ Term (â„‚ noAt) A â†’ Set where
-- work in progress
\end{code}\end{center}
\begin{code}[hide]
instance
  opaque
    unfolding noAt
    noAt-monad : âˆ€ {â„“} {l} â†’ RawMonad {â„“} (Î» A â†’ noAt A l)
    noAt-monad = mkRawMonad _ (Î» x â†’ x) (Î» x f â†’ f x)
\end{code}
%
%% A network is a mapping from locations to processes, and a partially applied EPP interprets a choreography as a network.
%% %
%% Networks have the following operational semantics:
%
\begin{center}\begin{code}[hide]
data _â‡’â¿_ {G : Loc â†’ Set} :
  ((l : Loc) â†’ Term â„™ (G l)) â†’ ((l : Loc) â†’ Term â„™ (G l)) â†’ Set where
-- work in progress
\end{code}\end{center}
%
%% Note that each process returns a value of type \textit{G \ l}, which allows each location to have a different return value.

%% \subsection{Soundness and Completeness}

%% Here is the standard definition of soundness and completeness:
%
\begin{center}\begin{code}[hide]
postulate
  soundness : âˆ€ {F} (c câ€² : Choreo F) â†’
    epp c â‡’â¿ epp câ€² â†’ c â‡’á¶œ câ€²

  completeness : âˆ€ {F} (c câ€² : Choreo F) â†’
    c â‡’á¶œ câ€² â†’ epp c â‡’â¿ epp câ€²
\end{code}\end{center}
%
%% Soundness (Completeness) says that the network preserves (reflects) the semantics of the original choreography.
%% %
%% We note that this is a form of bisimulation where the two systems are related in locked steps.
